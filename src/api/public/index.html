<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Socket.IO Chat Example</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h1>Communicating with socket .io!</h1>
    <p><input type="button" value="Poke the server" id="poke" /></p>
    <p><input type="txt" value="" id="input" /></p>
    <div id="content"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
    <script>
        // var token = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI1YmY0ZGVhMjAyYjFiZDUxMDIyYzEwZmYiLCJ1c2VyIjp7Il9pZCI6IjViZjRkZWEyMDJiMWJkNTEwMjJjMTBmZiIsImZ1bGxuYW1lIjoiRGVtbyAxIiwidXNlcm5hbWUiOiJEZW1vMSIsImctcmVjYXB0Y2hhLXJlc3BvbnNlIjoiIiwiaGFzaCI6IiQyYSQxMCRUZnBBME5BbzUwdUVKYXE5dFY4dnJ1MTU3ZC4uYmc3d1Jud3VlNm9HWDhPUFg2ZkZWUVNFUyIsInBob25lIjoiMDEyMzIxNDIzMzIiLCJjb3VudHJ5Y29kZSI6Iis4NCIsIm1vZHRpbWUiOiIxNTQyOTAzNjE4MzEyIiwiaW50cm9kdWN0aW9uIjoiRGVtbzIyMjIiLCJ5ZWFyb2ZiaXJ0aCI6IjE5OTYiLCJnZW5kZXIiOiIxIiwiZW1haWwiOiJob2FuZ2tpbXR1YW4xOTk2QGdtYWlsLmNvbTIiLCJhZGRyZXNzIjoiUXVhbiAyIiwidGF4bnVtYmVyIjoiMTIzNDU2Iiwic3BlYWtpbmdsYW5ndWFnZXMiOiJFbmdsaXNoIiwic29jaWFsbWVkaWFsaW5rIjoiRGVtbzIiLCJjb21wYW55Ijp7Im5hbWUiOiJDw5RORyBUWSBD4buUIFBI4bqmTiBE4buKQ0ggVuG7pCBWw4AgxJDhuqZVIFTGryBN4buYVCBD4busQSBRVeG7kEMgR0lBIiwiX2lkIjoiNWIwNjRiYTVkYzk3NTMwOWI4ZmFiODI3IiwidXJsIjoiY29uZy10eS1jby1waGFuLWRpY2gtdnUtdmEtZGF1LXR1LW1vdC1jdWEtcXVvYy1naWEifSwiYXZhdGFyIjp7InVybCI6Imh0dHA6Ly9zc28ubnNvLnZuL2ltYWdlcy9hdmF0YXJzLzViZjRkZWEyMDJiMWJkNTEwMjJjMTBmZi5qcGc_ZGF0ZT0xNTQyOTAzNjE4Mjk5IiwiX2lkIjoiNWJmNmQ3NDIwNDBlYWMyY2NjOTMyM2IxIn19LCJpYXQiOjE1NDI5NjUzMTR9.Mo5oBhe9ltS6MyyBXM_2PVL4VDSpQzcK_yEsrA-ItaE';
        var token = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI1YmY4ZDhlYmJkYTQ0YzUwMTVkODliZGUiLCJ1c2VyIjp7Il9pZCI6IjViZjhkOGViYmRhNDRjNTAxNWQ4OWJkZSIsImZ1bGxuYW1lIjoiTmd1eWVuIFBodSBUdWFuIiwidXNlcm5hbWUiOiJuZ3V5ZW5waHV0dWFuIiwiaGFzaCI6IiQyYSQxMCRUVG9nY1doY0swMzhZd0k1WWhaZ2dPTjZSSkJPcHBDTDgyU0xpTmtmWlBnS0pxOEJ6MEdYVyIsImNyZWF0ZXRpbWUiOiIxNTQzMDM1MTE1OTQ2IiwiY291bnRyeWNvZGUiOiIrODQiLCJtb2R0aW1lIjoiMTU0MzAzNTE4NDQ1NSIsInBob25lIjoiMDE2Mzc0Nzk3NjAifSwiaWF0IjoxNTQzMDM3MTA2fQ.2IvBwiCrl6Chh2t1zN1WS18Q8p4jszF0LULtgiUuTwk';
        // const socket = io.connect('https://chatnso.gitosolutions.com', { query : { 'token' : token } });
        // const socket = io.connect('https://nso.gitosolutions.com', { query : { 'token' : token } });
        const socket = io.connect('http://localhost:4040', { query : { 'token' : token } });
        socket.on('send-message', function (message) {
            console.log(JSON.stringify(message))
            // console.log(`${message.results.creatorId.fullname} send: ${message.results.desc}`);
            $('#content').append(`${message.results.creatorId.fullname} send: ${message.results.desc}</p>`)
        })
        socket.on('typing', function(data) {
            console.log(data)
            $('#content').append(`<p>Typing</p>`)
        });
        socket.on('edit-message', function(data) {
            console.log(data)
            // $('#content').append(`<p>Typing</p>`)
        });
        socket.on('del-message', function(data) {
            console.log(data)
            // $('#content').append(`<p>Typing</p>`)
        });
        $('#poke').click(function () {
            var input = document.getElementById("input").value;
            socket.emit('send-message', {
                receiverId: '5bf8d71bbda44c5015d89bdd',
                desc: input,
            });
            // $('#content').append(`<p>You chat: ${input}</p>`)
            // socket.emit('typing', {
            //     receiverId: '5be99326844f461870f2f4d3',
            //     type: 0,
            // });
            var input = document.getElementById("input").value;
            // socket.emit('edit-message', {
            //     msgId: '5bec4cf216d177c373ad95f9',
            //     desc: input,
            // });
            // socket.emit('del-message', {
            //     msgId: '5bec4cf216d177c373ad95f9'
            // });
            // socket.emit('join-conversation', {
            //     userId: '5be99326844f461870f2f4d3'
            // });
        })
    </script>
</body>

</html>

<!-- { 
  // window.socket = io.connect(server_chat, { 
      path: '/chat/socket.io/',
      // path: '/socket.io/',
      query : { 'token' : token } 
  } -->